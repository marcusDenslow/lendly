{% extends 'skiutlan/base.html' %}

{% block title %}Utlån #{{ utlan.id }} - Skiutlån System{% endblock %}

{% block content %}
<div class="row">
    <div class="col-md-8">
        <div class="card">
            <div class="card-header d-flex justify-content-between align-items-center">
                <h2>Utlån #{{ utlan.id }}</h2>
                <div>
                    {% if utlan.returnert_dato %}
                        <span class="badge bg-success">Returnert</span>
                    {% else %}
                        {% if utlan.er_forsinket %}
                            <span class="badge bg-danger">Forsinket</span>
                        {% else %}
                            <span class="badge bg-warning">Aktiv</span>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-6">
                        <h5>Bruker</h5>
                        <p><strong>Navn:</strong>
                            <a href="{% url 'skiutlan:bruker_detalj' utlan.bruker.id %}">
                                {{ utlan.bruker.fornavn }} {{ utlan.bruker.etternavn }}
                            </a>
                        </p>
                        <p><strong>Telefon:</strong> {{ utlan.bruker.telefon }}</p>
                        <p><strong>E-post:</strong> {{ utlan.bruker.epost|default:"Ikke oppgitt" }}</p>
                    </div>
                    <div class="col-md-6">
                        <h5>Ski-utstyr</h5>
                        <p><strong>Navn:</strong>
                            <a href="{% url 'skiutlan:ski_item_detalj' utlan.ski_item.id %}">
                                {{ utlan.ski_item.navn }}
                            </a>
                        </p>
                        <p><strong>Type:</strong> {{ utlan.ski_item.get_type_ski_display }}</p>
                        <p><strong>Størrelse:</strong> {{ utlan.ski_item.storrelse }}
                        {% if utlan.ski_item.type_ski == 'stovler' %}EU{% else %}cm{% endif %}</p>
                    </div>
                </div>

                <hr>

                <div class="row">
                    <div class="col-md-6">
                        <h5>Utlånsinformasjon</h5>
                        <p><strong>Utlånt:</strong> {{ utlan.utlant_dato|date:"d.m.Y H:i" }}</p>
                        <p><strong>Planlagt retur:</strong> {{ utlan.planlagt_retur|date:"d.m.Y H:i" }}</p>
                        {% if utlan.returnert_dato %}
                            <p><strong>Faktisk retur:</strong> {{ utlan.returnert_dato|date:"d.m.Y H:i" }}</p>
                        {% endif %}
                    </div>
                    <div class="col-md-6">
                        <h5>Varighet</h5>
                        {% if utlan.returnert_dato %}
                            <p><strong>Total varighet:</strong>
                                {{ utlan.returnert_dato|timeuntil:utlan.utlant_dato }}</p>
                        {% else %}
                            <p><strong>Varighet så langt:</strong>
                                {{ utlan.utlant_dato|timesince }}</p>
                        {% endif %}
                    </div>
                </div>

                <div class="mt-3">
                    {% if not utlan.returnert_dato %}
                        <a href="{% url 'skiutlan:utlan_marker_returnert' utlan.id %}" class="btn btn-success">Marker som returnert</a>
                    {% endif %}
                    <a href="{% url 'skiutlan:utlan_liste' %}" class="btn btn-secondary">Tilbake til liste</a>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}